/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e={967:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AuthenticationHandler:()=>v,AuthenticationHandlerOptions:()=>f,BatchRequestContent:()=>a,BatchResponseContent:()=>c,ChaosHandler:()=>D,ChaosHandlerOptions:()=>A,ChaosStrategy:()=>k,Client:()=>X,CustomAuthenticationProvider:()=>N,FeatureUsageFlag:()=>m,GraphError:()=>$,GraphRequest:()=>V,HTTPMessageHandler:()=>g,ImplicitMSALAuthenticationProvider:()=>ce,LargeFileUploadTask:()=>L,MSALAuthenticationProviderOptions:()=>de,MiddlewareFactory:()=>C,OneDriveLargeFileUploadTask:()=>M,PageIterator:()=>I,RedirectHandler:()=>E,RedirectHandlerOptions:()=>T,ResponseType:()=>F,RetryHandler:()=>b,RetryHandlerOptions:()=>w,TelemetryHandler:()=>S,TelemetryHandlerOptions:()=>y});var n,i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function r(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function s(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(n||(n={}));class a{constructor(e){if(this.requests=new Map,void 0!==e){const t=a.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let o=t.next();for(;!o.done;){const e=o.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;o=t.next()}return!0})(e)||(e=>{const t=e.entries();let o=t.next();const n=o.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;let i=o;for(o=t.next();!o.done;){const e=o.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=o,o=t.next()}return!0})(e)||(e=>{const t=e.entries();let o=t.next();const n=o.value[1];let i;if(void 0===n.dependsOn||0===n.dependsOn.length)i=n.id;else{if(1!==n.dependsOn.length)return!1;{const t=n.dependsOn[0];if(t===n.id||!e.has(t))return!1;i=t}}for(o=t.next();!o.done;){const e=o.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&i!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===i||e.dependsOn[0]!==i))return!1;if(e.dependsOn.length>1)return!1}o=t.next()}return!0})(e)}static getRequestData(e){return s(this,void 0,void 0,(function*(){const t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const i={};return e.headers.forEach(((e,t)=>{i[t]=e})),Object.keys(i).length&&(t.headers=i),e.method!==n.PATCH&&e.method!==n.POST&&e.method!==n.PUT||(t.body=yield a.getRequestBody(e)),t}))}static getRequestBody(e){return s(this,void 0,void 0,(function*(){let t,o=!1;try{const n=e.clone();t=yield n.json(),o=!0}catch(e){}if(!o)try{if("undefined"!=typeof Blob){const o=yield e.blob(),n=new FileReader;t=yield new Promise((e=>{n.addEventListener("load",(()=>{const t=n.result,o=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(o[4])}),!1),n.readAsDataURL(o)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));o=!0}catch(e){}return t}))}addRequest(e){const t=a.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),o=this.requests.entries();let n=o.next();for(;!n.done;){const t=n.value[1].dependsOn;if(void 0!==t){const o=t.indexOf(e);-1!==o&&t.splice(o,1),0===t.length&&delete n.value[1].dependsOn}n=o.next()}return t}getContent(){return s(this,void 0,void 0,(function*(){const e=[],t={requests:e},o=this.requests.entries();let n=o.next();if(n.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!a.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!n.done;){const t=n.value[1],i=yield a.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),n=o.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const o=this.requests.get(e);if(void 0===o.dependsOn&&(o.dependsOn=[]),-1!==o.dependsOn.indexOf(t)){const o=new Error(`Dependency ${t} is already added for the request ${e}`);throw o.name="Duplicate Dependency",o}o.dependsOn.push(t)}else{const o=this.requests.entries();let n,i=o.next();for(;!i.done&&i.value[1].id!==e;)n=i,i=o.next();if(void 0===n){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=n.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){const o=new Error(`Dependency ${t} is already added for the request ${e}`);throw o.name="Duplicate Dependency",o}i.value[1].dependsOn.push(t)}}}removeDependency(e,t){const o=this.requests.get(e);if(void 0===o||void 0===o.dependsOn||0===o.dependsOn.length)return!1;if(void 0!==t){const e=o.dependsOn.indexOf(t);return-1!==e&&(o.dependsOn.splice(e,1),!0)}return delete o.dependsOn,!0}}a.requestLimit=20;class c{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,o={};if(o.status=e.status,void 0!==e.statusText&&(o.statusText=e.statusText),o.headers=e.headers,void 0!==o.headers&&void 0!==o.headers["Content-Type"]&&"application/json"===o.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,o)}return new Response(t,o)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,o=t.length;e<o;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}class d{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const l=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},u=(e,t,o)=>{let n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(o);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(o);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===o){n=e[t][1];break}}else void 0!==t.headers[o]&&(n=t.headers[o]);return n},h=(e,t,o,n)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(o,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[o]:n});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(o,n);else if(t.headers instanceof Array){let e=0;const i=t.headers.length;for(;e<i;e++){const i=t.headers[e];if(i[0]===o){i[1]=n;break}}e===i&&t.headers.push([o,n])}else Object.assign(t.headers,{[o]:n})},p=(e,t,o,n)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(o,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[o]:n}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(o,n):t.headers instanceof Array?t.headers.push([o,n]):void 0===t.headers?t.headers={[o]:n}:void 0===t.headers[o]?t.headers[o]=n:t.headers[o]+=`, ${n}`)};class f{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var m;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(m||(m={}));class y{constructor(){this.featureUsage=m.NONE}static updateFeatureUsageFlag(e,t){let o;e.middlewareControl instanceof d?o=e.middlewareControl.getMiddlewareOptions(y):e.middlewareControl=new d,void 0===o&&(o=new y,e.middlewareControl.setMiddlewareOptions(y,o)),o.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class v{constructor(e){this.authenticationProvider=e}execute(e){return s(this,void 0,void 0,(function*(){try{let t,o,n;e.middlewareControl instanceof d&&(t=e.middlewareControl.getMiddlewareOptions(f)),void 0!==t&&(o=t.authenticationProvider,n=t.authenticationProviderOptions),void 0===o&&(o=this.authenticationProvider);const i=`Bearer ${yield o.getAccessToken(n)}`;return p(e.request,e.options,v.AUTHORIZATION_HEADER,i),y.updateFeatureUsageFlag(e,m.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}v.AUTHORIZATION_HEADER="Authorization";class g{execute(e){return s(this,void 0,void 0,(function*(){try{return void(e.response=yield fetch(e.request,e.options))}catch(e){throw e}}))}}class w{constructor(e=w.DEFAULT_DELAY,t=w.DEFAULT_MAX_RETRIES,o=w.DEFAULT_SHOULD_RETRY){if(e>w.MAX_DELAY&&t>w.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${w.MAX_DELAY} and ${w.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>w.MAX_DELAY){const e=new Error(`Delay should not be more than ${w.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>w.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${w.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,w.MAX_DELAY),this.maxRetries=Math.min(t,w.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return w.MAX_DELAY}}w.DEFAULT_DELAY=3,w.DEFAULT_MAX_RETRIES=3,w.MAX_DELAY=180,w.MAX_MAX_RETRIES=10,w.DEFAULT_SHOULD_RETRY=()=>!0;class b{constructor(e=new w){this.options=e}isRetry(e){return-1!==b.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const o="string"==typeof e?t.method:e.method;return o!==n.PUT&&o!==n.PATCH&&o!==n.POST||"application/octet-stream"!==u(e,t,"Content-Type")}getDelay(e,t,o){const n=()=>Number(Math.random().toFixed(3)),i=void 0!==e.headers?e.headers.get(b.RETRY_AFTER_HEADER):null;let r;return r=null!==i?Number.isNaN(Number(i))?Math.round((new Date(i).getTime()-Date.now())/1e3):Number(i):t>=2?this.getExponentialBackOffTime(t)+o+n():o+n(),Math.min(r,this.options.getMaxDelay()+n())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return s(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof d&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new w,this.options)),t}executeWithRetry(e,t,o){return s(this,void 0,void 0,(function*(){try{if(yield this.nextMiddleware.execute(e),t<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,t,e.request,e.options,e.response)){++t,h(e.request,e.options,b.RETRY_ATTEMPT_HEADER,t.toString());const n=this.getDelay(e.response,t,o.delay);return yield this.sleep(n),yield this.executeWithRetry(e,t,o)}return}catch(e){throw e}}))}execute(e){return s(this,void 0,void 0,(function*(){try{const t=0,o=this.getOptions(e);return y.updateFeatureUsageFlag(e,m.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,t,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}b.RETRY_STATUS_CODES=[429,503,504],b.RETRY_ATTEMPT_HEADER="Retry-Attempt",b.RETRY_AFTER_HEADER="Retry-After";class T{constructor(e=T.DEFAULT_MAX_REDIRECTS,t=T.DEFAULT_SHOULD_RETRY){if(e>T.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${T.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}T.DEFAULT_MAX_REDIRECTS=5,T.MAX_MAX_REDIRECTS=20,T.DEFAULT_SHOULD_RETRY=()=>!0;class E{constructor(e=new T){this.options=e}isRedirect(e){return-1!==E.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(E.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(E.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,n=o.exec(e);let i,r;null!==n&&(i=n[0]);const s=o.exec(t);return null!==s&&(r=s[0]),void 0!==i&&void 0!==r&&i!==r}updateRequestUrl(e,t){return s(this,void 0,void 0,(function*(){var o,n;t.request="string"==typeof t.request?e:yield(o=e,n=t.request,s(void 0,void 0,void 0,(function*(){const e=n.headers.get("Content-Type")?yield n.blob():yield Promise.resolve(void 0),{method:t,headers:i,referrer:r,referrerPolicy:s,mode:a,credentials:c,cache:d,redirect:l,integrity:u,keepalive:h,signal:p}=n;return new Request(o,{method:t,headers:i,body:e,referrer:r,referrerPolicy:s,mode:a,credentials:c,cache:d,redirect:l,integrity:u,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof d&&(t=e.middlewareControl.getMiddlewareOptions(T)),void 0===t&&(t=Object.assign(new T,this.options)),t}executeWithRedirect(e,t,o){return s(this,void 0,void 0,(function*(){try{yield this.nextMiddleware.execute(e);const i=e.response;if(!(t<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)))return;if(++t,i.status===E.STATUS_CODE_SEE_OTHER)e.options.method=n.GET,delete e.options.body;else{const t=this.getLocationHeader(i);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(i.url,t)&&delete e.options.headers[E.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,o)}catch(e){throw e}}))}execute(e){return s(this,void 0,void 0,(function*(){try{const t=0,o=this.getOptions(e);return e.options.redirect=E.MANUAL_REDIRECT,y.updateFeatureUsageFlag(e,m.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,t,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}E.REDIRECT_STATUS_CODES=[301,302,303,307,308],E.STATUS_CODE_SEE_OTHER=303,E.LOCATION_HEADER="Location",E.AUTHORIZATION_HEADER="Authorization",E.MANUAL_REDIRECT="manual";const _=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),x=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],R=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};class S{execute(e){return s(this,void 0,void 0,(function*(){try{if((e=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const t=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let n="";if(-1!==o)return-1!==t&&t<o?(n=e.substring(0,t),_.has(n)):(n=e.substring(0,o),_.has(n))}return!1})("string"==typeof e.request?e.request:e.request.url)){let t=u(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER);t||(t=l(),h(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER,t));let o,n=`${S.PRODUCT_NAME}/2.2.1`;if(e.middlewareControl instanceof d&&(o=e.middlewareControl.getMiddlewareOptions(y)),o){const e=o.getFeatureUsage();n+=` (${S.FEATURE_USAGE_STRING}=${e})`}p(e.request,e.options,S.SDK_VERSION_HEADER,n)}else delete e.options.headers[S.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[S.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}S.CLIENT_REQUEST_ID_HEADER="client-request-id",S.SDK_VERSION_HEADER="SdkVersion",S.PRODUCT_NAME="graph-js",S.FEATURE_USAGE_STRING="featureUsage";class C{static getDefaultMiddlewareChain(e){const t=[],o=new v(e),n=new b(new w),i=new S,r=new g;if(t.push(o),t.push(n),"object"==typeof process){const e=new E(new T);t.push(e)}return t.push(i),t.push(r),t}}var k;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(k||(k={}));class A{constructor(e=k.RANDOM,t="Some error Happened",o,n,i){if(this.chaosStrategy=e,this.statusCode=o,this.statusMessage=t,this.chaosPercentage=void 0!==n?n:10,this.responseBody=i,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const O={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},P={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class D{constructor(e=new A,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,o){const n=new Headers;return n.append("Cache-Control","no-store"),n.append("request-id",t),n.append("client-request-id",t),n.append("x-ms-ags-diagnostic",""),n.append("Date",o),n.append("Strict-Transport-Security",""),429===e&&n.append("retry-after","300"),n}createResponseBody(e,t,o,n,i){if(i)return i;let r;return r=e>=400?{error:{code:P[e],message:t,innerError:{"request-id":o,date:n}}}:{},r}createResponse(e,t){try{let o,n,i,r;const s=t.request;i=l(),r=new Date,n=this.createResponseHeaders(e.statusCode,i,r.toString()),o=this.createResponseBody(e.statusCode,e.statusMessage,i,r.toString(),e.responseBody);const a={url:s,status:e.statusCode,statusText:e.statusMessage,headers:n};t.response=new Response(o,a)}catch(e){throw e}}sendRequest(e,t){return s(this,void 0,void 0,(function*(){try{this.setStatusCode(e,t.request,t.options.method),e.statusCode?this.createResponse(e,t):yield this.nextMiddleware.execute(t)}catch(e){throw e}}))}getRandomStatusCode(e){try{const t=O[e];return t[Math.floor(Math.random()*t.length)]}catch(e){throw e}}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let o;return null!==t.exec(e)&&(o=t.exec(e)[1]),o}setStatusCode(e,t,o){try{if(e.chaosStrategy===k.MANUAL){if(void 0===e.statusCode){const n=this.getRelativeURL(t);void 0!==this.manualMap.get(n)?void 0!==this.manualMap.get(n).get(o)&&(e.statusCode=this.manualMap.get(n).get(o)):this.manualMap.forEach(((t,i)=>{new RegExp(i+"$").test(n)&&void 0!==this.manualMap.get(i).get(o)&&(e.statusCode=this.manualMap.get(i).get(o))}))}}else Math.floor(100*Math.random())<e.chaosPercentage&&(e.statusCode=this.getRandomStatusCode(o))}catch(e){throw e}}getOptions(e){let t;return e.middlewareControl instanceof d&&(t=e.middlewareControl.getMiddlewareOptions(A)),void 0===t&&(t=Object.assign(new A,this.options)),t}execute(e){return s(this,void 0,void 0,(function*(){try{const t=this.getOptions(e);return yield this.sendRequest(t,e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}class U{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class L{constructor(e,t,o,n={}){this.DEFAULT_FILE_SIZE=5242880,this.client=e,this.file=t,void 0===n.rangeSize&&(n.rangeSize=this.DEFAULT_FILE_SIZE),this.options=n,this.uploadSession=o,this.nextRange=new U(0,this.options.rangeSize-1)}static createUploadSession(e,t,o,n={}){return s(this,void 0,void 0,(function*(){try{const i=yield e.api(t).headers(n).post(o);return{url:i.uploadUrl,expiry:new Date(i.expirationDateTime)}}catch(e){throw e}}))}parseRange(e){const t=e[0];if(void 0===t||""===t)return new U;const o=t.split("-"),n=parseInt(o[0],10);let i=parseInt(o[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new U(n,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new U(e,t)}sliceFile(e){return this.file.content.slice(e.minValue,e.maxValue+1)}upload(){return s(this,void 0,void 0,(function*(){try{for(;;){const e=this.getNextRange();if(-1===e.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const t=this.sliceFile(e),o=yield this.uploadSlice(t,e,this.file.size);if(void 0!==o.id)return o;this.updateTaskStatus(o)}}catch(e){throw e}}))}uploadSlice(e,t,o){return s(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`}).put(e)}catch(e){throw e}}))}cancel(){return s(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).delete()}catch(e){throw e}}))}getStatus(){return s(this,void 0,void 0,(function*(){try{const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}catch(e){throw e}}))}resume(){return s(this,void 0,void 0,(function*(){try{return yield this.getStatus(),yield this.upload()}catch(e){throw e}}))}}class M extends L{constructor(e,t,o,n){super(e,t,o,n)}static constructCreateSessionUrl(e,t=M.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static create(e,t,o){return s(this,void 0,void 0,(function*(){const n=o.fileName;let i,r;if("undefined"!=typeof Blob&&t instanceof Blob)i=new File([t],n),r=i.size;else if("undefined"!=typeof File&&t instanceof File)i=t,r=i.size;else if("undefined"!=typeof Buffer&&t instanceof Buffer){const e=t;r=e.byteLength-e.byteOffset,i=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}try{const t=M.constructCreateSessionUrl(o.fileName,o.path),s=yield M.createUploadSession(e,t,o.fileName),a=((e=5242880)=>{const t=62914560;return e>t&&(e=t),(o=e)>327680&&(o=320*Math.floor(o/327680)*1024),o;var o})(o.rangeSize);return new M(e,{name:n,content:i,size:r},s,{rangeSize:a})}catch(e){throw e}}))}static createUploadSession(e,t,o){const n=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return s(this,void 0,void 0,(function*(){const i={item:{"@microsoft.graph.conflictBehavior":"rename",name:o}};try{return n.createUploadSession.call(this,e,t,i)}catch(e){throw e}}))}commit(e){return s(this,void 0,void 0,(function*(){try{const t={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(t)}catch(e){throw e}}))}}M.DEFAULT_UPLOAD_PATH="/";class I{constructor(e,t,o,n){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=o,this.complete=!1,this.requestOptions=n}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&0!==this.collection.length;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return s(this,void 0,void 0,(function*(){try{let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]}catch(e){throw e}}))}getDeltaLink(){return this.deltaLink}iterate(){return s(this,void 0,void 0,(function*(){try{let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)}catch(e){throw e}}))}resume(){return s(this,void 0,void 0,(function*(){try{return this.iterate()}catch(e){throw e}}))}isComplete(){return this.complete}}class N{constructor(e){this.provider=e}getAccessToken(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((o,n)=>{n?e(n):t(o)}))}))}))}}class $ extends Error{constructor(e=-1,t,o){super(t||o&&o.message),Object.setPrototypeOf(this,$.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}class q{static constructError(e,t){const o=new $(t,"",e);return void 0!==e.name&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o}static constructErrorFromResponse(e,t){e=e.error;const o=new $(t,e.message);o.code=e.code,void 0!==e.innerError&&(o.requestId=e.innerError["request-id"],o.date=new Date(e.innerError.date));try{o.body=JSON.stringify(e)}catch(e){}return o}static getError(e=null,t=-1,o){return s(this,void 0,void 0,(function*(){let n;if(n=e&&e.error?q.constructErrorFromResponse(e,t):"undefined"!=typeof Error&&e instanceof Error?q.constructError(e,t):new $(t),"function"!=typeof o)return n;o(n,null)}))}}var F,j,H,B;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(F||(F={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(j||(j={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(H||(H={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(B||(B={}));class z{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise(((o,n)=>{e.text().then((e=>{try{const n=(new DOMParser).parseFromString(e,t);o(n)}catch(e){n(e)}}))})):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(e,t){return s(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let o;try{switch(t){case F.ARRAYBUFFER:o=yield e.arrayBuffer();break;case F.BLOB:o=yield e.blob();break;case F.DOCUMENT:o=yield z.parseDocumentResponse(e,j.TEXT_XML);break;case F.JSON:o=yield e.json();break;case F.STREAM:o=yield Promise.resolve(e.body);break;case F.TEXT:o=yield e.text();break;default:const t=e.headers.get("Content-type");if(null!==t){const n=t.split(";")[0];o=new RegExp(B.DOCUMENT).test(n)?yield z.parseDocumentResponse(e,n):new RegExp(B.IMAGE).test(n)?e.blob():n===H.TEXT_PLAIN?yield e.text():n===H.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else o=Promise.resolve(e.body)}}catch(e){throw e}return o}))}static getResponse(e,t,o){return s(this,void 0,void 0,(function*(){try{if(t===F.RAW)return Promise.resolve(e);{const n=yield z.convertResponse(e,t);if(!e.ok)throw n;if("function"!=typeof o)return n;o(null,n)}}catch(e){throw e}}))}}class V{constructor(e,t,o){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const o=e.indexOf("/");-1!==o&&(this.urlComponents.version=e.substring(0,o),e=e.substring(o+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const o=e.substring(t+1,e.length).split("&");for(const e of o)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(e,t,o){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let n=[];o.length>1&&"string"==typeof t?n=Array.prototype.slice.call(o):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,o)=>{return[(n=e,n.replace(/\/+$/,"")),t(o)].join("/");var n}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const o in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(o)&&t.push(o+"="+e.oDataQueryParams[o]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const o in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(o)&&t.push(o+"="+e.otherURLQueryParams[o]);if(0!==e.otherURLQueryOptions.length)for(const o of e.otherURLQueryOptions)t.push(o);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)e.hasOwnProperty(t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),o=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(o,n)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==x.indexOf(e)){const o=this.urlComponents.oDataQueryParams[e],n=o&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?o+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,o){return s(this,void 0,void 0,(function*(){let n;const i=new d(this._middlewareOptions);this.updateRequestOptions(t);try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i})).response,yield z.getResponse(n,this._responseType,o)}catch(e){let t;throw void 0!==n&&(t=n.status),yield q.getError(e,t,o)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!1){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:n.GET};try{return yield this.send(t,o,e)}catch(e){throw e}}))}post(e,t){return s(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:n.POST,body:R(e)};"FormData"===(e&&e.constructor&&e.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers);try{return yield this.send(o,i,t)}catch(e){throw e}}))}create(e,t){return s(this,void 0,void 0,(function*(){try{return yield this.post(e,t)}catch(e){throw e}}))}put(e,t){return s(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:n.PUT,body:R(e)};try{return yield this.send(o,i,t)}catch(e){throw e}}))}patch(e,t){return s(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:n.PATCH,body:R(e)};try{return yield this.send(o,i,t)}catch(e){throw e}}))}update(e,t){return s(this,void 0,void 0,(function*(){try{return yield this.patch(e,t)}catch(e){throw e}}))}delete(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:n.DELETE};try{return yield this.send(t,o,e)}catch(e){throw e}}))}del(e){return s(this,void 0,void 0,(function*(){try{return yield this.delete(e)}catch(e){throw e}}))}getStream(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:n.GET};this.responseType(F.STREAM);try{return yield this.send(t,o,e)}catch(e){throw e}}))}putStream(e,t){return s(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:n.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};try{return yield this.send(o,i,t)}catch(e){throw e}}))}}class Q{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,o)=>{o<e.length-1&&t.setNext(e[o+1])})),this.middleware=e[0]}sendRequest(e){return s(this,void 0,void 0,(function*(){try{if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}catch(e){throw e}}))}}class W{static createWithAuthenticationProvider(e){const t=new v(e),o=new b(new w),n=new S,i=new g;if(t.setNext(o),"object"==typeof process){const e=new E(new T);o.setNext(e),e.setNext(n)}else o.setNext(n);return n.setNext(i),W.createWithMiddleware(t)}static createWithMiddleware(...e){return new Q(...e)}}class X{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=W.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Q(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const o in e)e.hasOwnProperty(o)&&(t[o]="authProvider"===o?new N(e[o]):e[o]);return X.initWithMiddleware(t)}static initWithMiddleware(e){try{return new X(e)}catch(e){throw e}}api(e){return new V(this.httpClient,this.config,e)}}var Y="unexpected_error",G="Unexpected error in authentication.",K="no_window_object",Z="No window object available. Details:",J=function(e){function t(o,n){var i=e.call(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i.errorCode=o,i.errorMessage=n,i.name="AuthError",i}return r(t,e),t.createUnexpectedError=function(e){return new t(Y,G+": "+e)},t.createNoWindowObjectError=function(e){return new t(K,Z+" "+e)},t}(Error),ee="server_unavailable",te="Server is temporarily unavailable.",oe="unknown_server_error",ne=function(e){function t(o,n){var i=e.call(this,o,n)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return r(t,e),t.createServerUnavailableError=function(){return new t(ee,te)},t.createUnknownServerError=function(e){return new t(oe,e)},t}(J),ie="interaction_required",re="consent_required",se="login_required",ae=function(e){function t(o,n){var i=e.call(this,o,n)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return r(t,e),t.isInteractionRequiredError=function(e){return e&&[ie,re,se].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(se,e)},t.createInteractionRequiredAuthError=function(e){return new t(ie,e)},t.createConsentRequiredAuthError=function(e){return new t(re,e)},t}(ne);class ce{constructor(e,t){this.options=t,this.msalApplication=e}getAccessToken(e){return s(this,void 0,void 0,(function*(){let t;if(void 0!==e&&(t=e.scopes),void 0!==t&&0!==t.length||(t=this.options.scopes),0===t.length){const e=new Error;throw e.name="EmptyScopes",e.message="Scopes cannot be empty, Please provide a scopes",e}if(this.msalApplication.getAccount()){const e={scopes:t};try{return(yield this.msalApplication.acquireTokenSilent(e)).accessToken}catch(t){if(!(t instanceof ae))throw t;try{return(yield this.msalApplication.acquireTokenPopup(e)).accessToken}catch(e){throw e}}}else try{const e={scopes:t};return yield this.msalApplication.loginPopup(e),(yield this.msalApplication.acquireTokenSilent(e)).accessToken}catch(e){throw e}}))}}class de{constructor(e){this.scopes=e}}},571:(e,t,o)=>{const n=o(165),i=n.fetch.bind({});i.polyfill=!0,global.fetch||(global.fetch=i,global.Response=n.Response,global.Headers=n.Headers,global.Request=n.Request)},165:(e,t,o)=>{const n=o(500),i=n.default||n,r=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),i.call(this,e,t)};r.ponyfill=!0,e.exports=t=r,t.fetch=r,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,t.default=r},500:(e,t,o)=>{"use strict";o.r(t),o.d(t,{FetchError:()=>h,Headers:()=>A,Request:()=>B,Response:()=>N,default:()=>X});const n=require("stream");var i=o(605),r=o(835);const s=require("https"),a=require("zlib"),c=n.Readable,d=Symbol("buffer"),l=Symbol("type");class u{constructor(){this[l]="";const e=arguments[0],t=arguments[1],o=[];let n=0;if(e){const t=e,i=Number(t.length);for(let e=0;e<i;e++){const i=t[e];let r;r=i instanceof Buffer?i:ArrayBuffer.isView(i)?Buffer.from(i.buffer,i.byteOffset,i.byteLength):i instanceof ArrayBuffer?Buffer.from(i):i instanceof u?i[d]:Buffer.from("string"==typeof i?i:String(i)),n+=r.length,o.push(r)}}this[d]=Buffer.concat(o);let i=t&&void 0!==t.type&&String(t.type).toLowerCase();i&&!/[^\u0020-\u007E]/.test(i)&&(this[l]=i)}get size(){return this[d].length}get type(){return this[l]}text(){return Promise.resolve(this[d].toString())}arrayBuffer(){const e=this[d],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new c;return e._read=function(){},e.push(this[d]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],o=arguments[1];let n,i;n=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),i=void 0===o?e:o<0?Math.max(e+o,0):Math.min(o,e);const r=Math.max(i-n,0),s=this[d].slice(n,n+r),a=new u([],{type:arguments[2]});return a[d]=s,a}}function h(e,t,o){Error.call(this,e),this.message=e,this.type=t,o&&(this.code=this.errno=o.code),Error.captureStackTrace(this,this.constructor)}let p;Object.defineProperties(u.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(u.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="FetchError";try{p=require("encoding").convert}catch(e){}const f=Symbol("Body internals"),m=n.PassThrough;function y(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.size;let r=void 0===i?0:i;var s=o.timeout;let a=void 0===s?0:s;null==e?e=null:g(e)?e=Buffer.from(e.toString()):w(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof n||(e=Buffer.from(String(e)))),this[f]={body:e,disturbed:!1,error:null},this.size=r,this.timeout=a,e instanceof n&&e.on("error",(function(e){const o="AbortError"===e.name?e:new h(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[f].error=o}))}function v(){var e=this;if(this[f].disturbed)return y.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[f].disturbed=!0,this[f].error)return y.Promise.reject(this[f].error);let t=this.body;if(null===t)return y.Promise.resolve(Buffer.alloc(0));if(w(t)&&(t=t.stream()),Buffer.isBuffer(t))return y.Promise.resolve(t);if(!(t instanceof n))return y.Promise.resolve(Buffer.alloc(0));let o=[],i=0,r=!1;return new y.Promise((function(n,s){let a;e.timeout&&(a=setTimeout((function(){r=!0,s(new h(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),t.on("error",(function(t){"AbortError"===t.name?(r=!0,s(t)):s(new h(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),t.on("data",(function(t){if(!r&&null!==t){if(e.size&&i+t.length>e.size)return r=!0,void s(new h(`content size at ${e.url} over limit: ${e.size}`,"max-size"));i+=t.length,o.push(t)}})),t.on("end",(function(){if(!r){clearTimeout(a);try{n(Buffer.concat(o,i))}catch(t){s(new h(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function g(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function w(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function b(e){let t,o,i=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof n&&"function"!=typeof i.getBoundary&&(t=new m,o=new m,i.pipe(t),i.pipe(o),e[f].body=t,i=o),i}function T(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":g(e)?"application/x-www-form-urlencoded;charset=UTF-8":w(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?`multipart/form-data;boundary=${e.getBoundary()}`:e instanceof n?null:"text/plain;charset=UTF-8"}function E(e){const t=e.body;return null===t?0:w(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}y.prototype={get body(){return this[f].body},get bodyUsed(){return this[f].disturbed},arrayBuffer(){return v.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return v.call(this).then((function(t){return Object.assign(new u([],{type:e.toLowerCase()}),{[d]:t})}))},json(){var e=this;return v.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return y.Promise.reject(new h(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return v.call(this).then((function(e){return e.toString()}))},buffer(){return v.call(this)},textConverted(){var e=this;return v.call(this).then((function(t){return function(e,t){if("function"!=typeof p)throw new Error("The package `encoding` must be installed to use the textConverted() function");const o=t.get("content-type");let n,i,r="utf-8";return o&&(n=/charset=([^;]*)/i.exec(o)),i=e.slice(0,1024).toString(),!n&&i&&(n=/<meta.+?charset=(['"])(.+?)\1/i.exec(i)),!n&&i&&(n=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(i),n||(n=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(i),n&&n.pop()),n&&(n=/charset=(.*)/i.exec(n.pop()))),!n&&i&&(n=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(i)),n&&(r=n.pop(),"gb2312"!==r&&"gbk"!==r||(r="gb18030")),p(e,"UTF-8",r).toString()}(t,e.headers)}))}},Object.defineProperties(y.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),y.mixIn=function(e){for(const t of Object.getOwnPropertyNames(y.prototype))if(!(t in e)){const o=Object.getOwnPropertyDescriptor(y.prototype,t);Object.defineProperty(e,t,o)}},y.Promise=global.Promise;const _=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,x=/[^\t\x20-\x7e\x80-\xff]/;function R(e){if(e=`${e}`,_.test(e)||""===e)throw new TypeError(`${e} is not a legal HTTP header name`)}function S(e){if(e=`${e}`,x.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function C(e,t){t=t.toLowerCase();for(const o in e)if(o.toLowerCase()===t)return o}const k=Symbol("map");class A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[k]=Object.create(null),e instanceof A){const t=e.raw(),o=Object.keys(t);for(const e of o)for(const o of t[e])this.append(e,o)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const o=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");o.push(Array.from(t))}for(const e of o){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const o=e[t];this.append(t,o)}}}}get(e){R(e=`${e}`);const t=C(this[k],e);return void 0===t?null:this[k][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=O(this),n=0;for(;n<o.length;){var i=o[n];const r=i[0],s=i[1];e.call(t,s,r,this),o=O(this),n++}}set(e,t){t=`${t}`,R(e=`${e}`),S(t);const o=C(this[k],e);this[k][void 0!==o?o:e]=[t]}append(e,t){t=`${t}`,R(e=`${e}`),S(t);const o=C(this[k],e);void 0!==o?this[k][o].push(t):this[k][e]=[t]}has(e){return R(e=`${e}`),void 0!==C(this[k],e)}delete(e){R(e=`${e}`);const t=C(this[k],e);void 0!==t&&delete this[k][t]}raw(){return this[k]}keys(){return D(this,"key")}values(){return D(this,"value")}[Symbol.iterator](){return D(this,"key+value")}}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const o=Object.keys(e[k]).sort();return o.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[k][t].join(", ")}:function(t){return[t.toLowerCase(),e[k][t].join(", ")]})}A.prototype.entries=A.prototype[Symbol.iterator],Object.defineProperty(A.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(A.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const P=Symbol("internal");function D(e,t){const o=Object.create(U);return o[P]={target:e,kind:t,index:0},o}const U=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==U)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[P];const t=e.target,o=e.kind,n=e.index,i=O(t,o);return n>=i.length?{value:void 0,done:!0}:(this[P].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function L(e){const t=Object.assign({__proto__:null},e[k]),o=C(e[k],"Host");return void 0!==o&&(t[o]=t[o][0]),t}Object.defineProperty(U,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const M=Symbol("Response internals"),I=i.STATUS_CODES;class N{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y.call(this,e,t);const o=t.status||200,n=new A(t.headers);if(null!=e&&!n.has("Content-Type")){const t=T(e);t&&n.append("Content-Type",t)}this[M]={url:t.url,status:o,statusText:t.statusText||I[o],headers:n,counter:t.counter}}get url(){return this[M].url||""}get status(){return this[M].status}get ok(){return this[M].status>=200&&this[M].status<300}get redirected(){return this[M].counter>0}get statusText(){return this[M].statusText}get headers(){return this[M].headers}clone(){return new N(b(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}y.mixIn(N.prototype),Object.defineProperties(N.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(N.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const $=Symbol("Request internals"),q=r.parse,F=r.format,j="destroy"in n.Readable.prototype;function H(e){return"object"==typeof e&&"object"==typeof e[$]}class B{constructor(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};H(e)?t=q(e.url):(t=e&&e.href?q(e.href):q(`${e}`),e={});let n=o.method||e.method||"GET";if(n=n.toUpperCase(),(null!=o.body||H(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");let i=null!=o.body?o.body:H(e)&&null!==e.body?b(e):null;y.call(this,i,{timeout:o.timeout||e.timeout||0,size:o.size||e.size||0});const r=new A(o.headers||e.headers||{});if(null!=i&&!r.has("Content-Type")){const e=T(i);e&&r.append("Content-Type",e)}let s=H(e)?e.signal:null;if("signal"in o&&(s=o.signal),null!=s&&!function(e){const t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!(!t||"AbortSignal"!==t.constructor.name)}(s))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[$]={method:n,redirect:o.redirect||e.redirect||"follow",headers:r,parsedURL:t,signal:s},this.follow=void 0!==o.follow?o.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==o.compress?o.compress:void 0===e.compress||e.compress,this.counter=o.counter||e.counter||0,this.agent=o.agent||e.agent}get method(){return this[$].method}get url(){return F(this[$].parsedURL)}get headers(){return this[$].headers}get redirect(){return this[$].redirect}get signal(){return this[$].signal}clone(){return new B(this)}}function z(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}y.mixIn(B.prototype),Object.defineProperty(B.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(B.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),z.prototype=Object.create(Error.prototype),z.prototype.constructor=z,z.prototype.name="AbortError";const V=n.PassThrough,Q=r.resolve;function W(e,t){if(!W.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return y.Promise=W.Promise,new W.Promise((function(o,r){const c=new B(e,t),d=function(e){const t=e[$].parsedURL,o=new A(e[$].headers);if(o.has("Accept")||o.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof n.Readable&&!j)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let i=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(i="0"),null!=e.body){const t=E(e);"number"==typeof t&&(i=String(t))}i&&o.set("Content-Length",i),o.has("User-Agent")||o.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!o.has("Accept-Encoding")&&o.set("Accept-Encoding","gzip,deflate");let r=e.agent;return"function"==typeof r&&(r=r(t)),o.has("Connection")||r||o.set("Connection","close"),Object.assign({},t,{method:e.method,headers:L(o),agent:r})}(c),l=("https:"===d.protocol?s:i).request,u=c.signal;let p=null;const f=function(){let e=new z("The user aborted a request.");r(e),c.body&&c.body instanceof n.Readable&&c.body.destroy(e),p&&p.body&&p.body.emit("error",e)};if(u&&u.aborted)return void f();const m=function(){f(),g()},y=l(d);let v;function g(){y.abort(),u&&u.removeEventListener("abort",m),clearTimeout(v)}u&&u.addEventListener("abort",m),c.timeout&&y.once("socket",(function(e){v=setTimeout((function(){r(new h(`network timeout at: ${c.url}`,"request-timeout")),g()}),c.timeout)})),y.on("error",(function(e){r(new h(`request to ${c.url} failed, reason: ${e.message}`,"system",e)),g()})),y.on("response",(function(e){clearTimeout(v);const t=function(e){const t=new A;for(const o of Object.keys(e))if(!_.test(o))if(Array.isArray(e[o]))for(const n of e[o])x.test(n)||(void 0===t[k][o]?t[k][o]=[n]:t[k][o].push(n));else x.test(e[o])||(t[k][o]=[e[o]]);return t}(e.headers);if(W.isRedirect(e.statusCode)){const n=t.get("Location"),i=null===n?null:Q(c.url,n);switch(c.redirect){case"error":return r(new h(`uri requested responds with a redirect, redirect mode is set to error: ${c.url}`,"no-redirect")),void g();case"manual":if(null!==i)try{t.set("Location",i)}catch(e){r(e)}break;case"follow":if(null===i)break;if(c.counter>=c.follow)return r(new h(`maximum redirect reached at: ${c.url}`,"max-redirect")),void g();const n={headers:new A(c.headers),follow:c.follow,counter:c.counter+1,agent:c.agent,compress:c.compress,method:c.method,body:c.body,signal:c.signal,timeout:c.timeout,size:c.size};return 303!==e.statusCode&&c.body&&null===E(c)?(r(new h("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void g()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==c.method)||(n.method="GET",n.body=void 0,n.headers.delete("content-length")),o(W(new B(i,n))),void g())}}e.once("end",(function(){u&&u.removeEventListener("abort",m)}));let n=e.pipe(new V);const i={url:c.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:c.size,timeout:c.timeout,counter:c.counter},s=t.get("Content-Encoding");if(!c.compress||"HEAD"===c.method||null===s||204===e.statusCode||304===e.statusCode)return p=new N(n,i),void o(p);const d={flush:a.Z_SYNC_FLUSH,finishFlush:a.Z_SYNC_FLUSH};if("gzip"==s||"x-gzip"==s)return n=n.pipe(a.createGunzip(d)),p=new N(n,i),void o(p);if("deflate"!=s&&"x-deflate"!=s){if("br"==s&&"function"==typeof a.createBrotliDecompress)return n=n.pipe(a.createBrotliDecompress()),p=new N(n,i),void o(p);p=new N(n,i),o(p)}else e.pipe(new V).once("data",(function(e){n=8==(15&e[0])?n.pipe(a.createInflate()):n.pipe(a.createInflateRaw()),p=new N(n,i),o(p)}))})),function(e,t){const o=t.body;null===o?e.end():w(o)?o.stream().pipe(e):Buffer.isBuffer(o)?(e.write(o),e.end()):o.pipe(e)}(y,c)}))}W.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},W.Promise=global.Promise;const X=W},353:(e,t,o)=>{e.exports=o(417).randomBytes},434:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MSAService=t.REFRESH_NETWORK_FAILURE=t.onDidChangeSessions=void 0;const i=o(353),r=o(191),s=o(293),a=o(549),c=o(277),d=o(165),l=o(404),u=o(409),h=o(220),p="https://extension-auth-redirect.azurewebsites.net/",f="https://login.microsoftonline.com/",m="a4fd7674-4ebd-4dbc-831c-338314dd459e";function y(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}t.onDidChangeSessions=new a.EventEmitter,t.REFRESH_NETWORK_FAILURE="Network failure";class v extends a.EventEmitter{handleUri(e){this.fire(e)}}t.MSAService=class{constructor(e){this._context=e,this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this._codeVerfifiers=new Map,this._keychain=new l.Keychain(e),this._uriHandler=new v,this._disposables.push(a.window.registerUriHandler(this._uriHandler))}initialize(){return n(this,void 0,void 0,(function*(){const e=yield this._keychain.getToken();if(e)try{const o=this.parseStoredData(e).map((e=>n(this,void 0,void 0,(function*(){var o;if(!e.refreshToken)return Promise.resolve();try{yield this.refreshToken(e.refreshToken,e.scope,e.id)}catch(n){n.message===t.REFRESH_NETWORK_FAILURE?(yield this.handleRefreshNetworkError(e.id,e.refreshToken,e.scope))||(this._tokens.push({accessToken:void 0,refreshToken:e.refreshToken,account:{label:null!==(o=e.account.label)&&void 0!==o?o:e.account.displayName,id:e.account.id},scope:e.scope,sessionId:e.id}),this.pollForReconnect(e.id,e.refreshToken,e.scope)):yield this.removeSession(e.id)}}))));yield Promise.all(o)}catch(e){console.info("Failed to initialize stored data"),yield this.clearSessions()}this._disposables.push(this._context.secrets.onDidChange((()=>this.checkForUpdates)))}))}parseStoredData(e){return JSON.parse(e)}storeTokenData(){return n(this,void 0,void 0,(function*(){const e=this._tokens.map((e=>({id:e.sessionId,refreshToken:e.refreshToken,scope:e.scope,account:e.account})));yield this._keychain.setToken(JSON.stringify(e))}))}checkForUpdates(){return n(this,void 0,void 0,(function*(){const e=[];let o=[];const i=yield this._keychain.getToken();if(i)try{const r=this.parseStoredData(i);let s=r.map((o=>n(this,void 0,void 0,(function*(){if(!this._tokens.some((e=>e.scope===o.scope&&e.sessionId===o.id))&&o.refreshToken)try{const t=yield this.refreshToken(o.refreshToken,o.scope,o.id);e.push(this.convertToSessionSync(t))}catch(e){e.message===t.REFRESH_NETWORK_FAILURE||(yield this.removeSession(o.id))}}))));s=s.concat(this._tokens.map((e=>n(this,void 0,void 0,(function*(){r.some((t=>e.scope===t.scope&&e.sessionId===t.id))||(yield this.removeSession(e.sessionId),o.push(this.convertToSessionSync(e)))}))))),yield Promise.all(s)}catch(e){console.error(e.message),o=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(o=this._tokens.map(this.convertToSessionSync),console.info("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach((e=>{clearTimeout(e)})),this._refreshTimeouts.clear());(e.length||o.length)&&t.onDidChangeSessions.fire({added:e,removed:o,changed:[]})}))}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,idToken:e.idToken,account:e.account,scopes:e.scope.split(" ")}}convertToSession(e){return n(this,void 0,void 0,(function*(){const t=yield this.resolveAccessAndIdTokens(e);return{id:e.sessionId,accessToken:t.accessToken,idToken:t.idToken,account:e.account,scopes:e.scope.split(" ")}}))}resolveAccessAndIdTokens(e){return n(this,void 0,void 0,(function*(){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?console.info(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):console.info("Token available from cache"),Promise.resolve({accessToken:e.accessToken,idToken:e.idToken});try{console.info("Token expired or unavailable, trying refresh");const t=yield this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(t.accessToken)return{accessToken:t.accessToken,idToken:t.idToken};throw new Error}catch(e){throw new Error("Unavailable due to network problems")}}))}getTokenClaims(e){try{return JSON.parse(s.Buffer.from(e.split(".")[1],"base64").toString())}catch(e){throw new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map((e=>this.convertToSession(e))))}getSessions(e){return n(this,void 0,void 0,(function*(){if(!e)return this.sessions;const t=e.sort().join(" "),o=this._tokens.filter((e=>e.scope===t));return Promise.all(o.map((e=>this.convertToSession(e))))}))}createSession(e){return n(this,void 0,void 0,(function*(){console.info("Logging in...");const t=void 0!==a.env.remoteName,o=void 0===a.env.remoteName&&a.env.uiKind===a.UIKind.Web;if(t||o)return yield this.loginWithoutLocalServer(e);const n=e.sort().join(" "),r=i(16).toString("base64"),{server:s,redirectPromise:c,codePromise:d}=u.createServer(r);let l;try{const e=yield u.startServer(s);a.env.openExternal(a.Uri.parse(`http://localhost:${e}/signin?nonce=${encodeURIComponent(r)}`));const t=yield c;if("err"in t){const{err:e,res:o}=t;throw o.writeHead(302,{Location:`/?error=${encodeURIComponent(e&&e.message||"Unknown error")}`}),o.end(),e}const o=t.req.headers.host||"",v=(/^[^:]+:(\d+)$/.exec(Array.isArray(o)?o[0]:o)||[])[1],g=`${v?parseInt(v,10):e},${encodeURIComponent(r)}`,w=y(i(32).toString("base64")),b=y(yield h.sha256(w)),T=`${f}common/oauth2/v2.0/authorize?response_type=code&response_mode=query&client_id=${encodeURIComponent(m)}&redirect_uri=${encodeURIComponent(p)}&state=${g}&scope=${encodeURIComponent(n)}&prompt=select_account&code_challenge_method=S256&code_challenge=${b}`;yield t.res.writeHead(302,{Location:T}),t.res.end();const E=yield d,_=E.res;try{if("err"in E)throw E.err;l=yield this.exchangeCodeForToken(E.code,w,n),this.setToken(l,n),console.log("Login successful");const e=yield this.convertToSession(l);return _.writeHead(302,{Location:"/"}),e}catch(e){throw _.writeHead(302,{Location:`/?error=${encodeURIComponent(e&&e.message||"Unknown error")}`}),e}finally{_.end()}}catch(t){if(console.error(t.message),"Error listening to server"===t.message||"Closed"===t.message||"Timeout waiting for port"===t.message)return yield this.loginWithoutLocalServer(e);throw t}finally{setTimeout((()=>{s.close()}),5e3)}}))}dispose(){this._disposables.forEach((e=>e.dispose())),this._disposables=[]}getCallbackEnvironment(e){if("https"!==e.scheme&&"http"!==e.scheme)return e.scheme;switch(e.authority){case"online.visualstudio.com":return"vso";case"online-ppe.core.vsengsaas.visualstudio.com":return"vsoppe";case"online.dev.core.vsengsaas.visualstudio.com":return"vsodev";default:return e.authority}}loginWithoutLocalServer(e){return n(this,void 0,void 0,(function*(){const t=yield a.env.asExternalUri(a.Uri.parse(`${a.env.uriScheme}://tylerleonhardt.msft-todo-unofficial`)),o=i(16).toString("base64"),n=(t.authority.match(/:([0-9]*)$/)||[])[1]||("https"===t.scheme?443:80),r=`${this.getCallbackEnvironment(t)},${n},${encodeURIComponent(o)},${encodeURIComponent(t.query)}`,s=`${f}common/oauth2/v2.0/authorize`;let c=a.Uri.parse(s);const d=y(i(32).toString("base64")),l=y(yield h.sha256(d)),u=e.sort().join(" ");c=c.with({query:`response_type=code&client_id=${encodeURIComponent(m)}&response_mode=query&redirect_uri=${p}&state=${r}&scope=${u}&prompt=select_account&code_challenge_method=S256&code_challenge=${l}`}),a.env.openExternal(c);const v=new Promise(((e,t)=>{const o=setTimeout((()=>{clearTimeout(o),t("Login timed out.")}),3e5)})),g=this._pendingStates.get(u)||[];this._pendingStates.set(u,[...g,r]);let w=this._codeExchangePromises.get(u);return w||(w=this.handleCodeResponse(u),this._codeExchangePromises.set(u,w)),this._codeVerfifiers.set(r,d),Promise.race([w,v]).finally((()=>{this._pendingStates.delete(u),this._codeExchangePromises.delete(u),this._codeVerfifiers.delete(r)}))}))}handleCodeResponse(e){return n(this,void 0,void 0,(function*(){let t;return new Promise(((o,i)=>{t=this._uriHandler.event((t=>n(this,void 0,void 0,(function*(){var n;try{const i=function(e){return e.query.split("&").reduce(((e,t)=>{const o=t.split("=");return e[o[0]]=o[1],e}),{})}(t),r=i.code,s=this._pendingStates.get(e)||[];if(!s.includes(i.state)&&!s.includes(decodeURIComponent(i.state)))throw new Error("State does not match.");const a=null!==(n=this._codeVerfifiers.get(i.state))&&void 0!==n?n:this._codeVerfifiers.get(decodeURIComponent(i.state));if(!a)throw new Error("No available code verifier");const c=yield this.exchangeCodeForToken(r,a,e);this.setToken(c,e);const d=yield this.convertToSession(c);o(d)}catch(e){i(e)}}))))})).then((e=>(t.dispose(),e))).catch((e=>{throw t.dispose(),e}))}))}setToken(e,o){return n(this,void 0,void 0,(function*(){const i=this._tokens.findIndex((t=>t.sessionId===e.sessionId));i>-1?this._tokens.splice(i,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout((()=>n(this,void 0,void 0,(function*(){try{const n=yield this.refreshToken(e.refreshToken,o,e.sessionId);t.onDidChangeSessions.fire({added:[],removed:[],changed:[this.convertToSessionSync(n)]})}catch(n){n.message===t.REFRESH_NETWORK_FAILURE?(yield this.handleRefreshNetworkError(e.sessionId,e.refreshToken,o))||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(yield this.removeSession(e.sessionId),t.onDidChangeSessions.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}}))),1e3*(e.expiresIn-30))),this.storeTokenData()}))}getTokenFromResponse(e,t,o){let n;try{n=this.getTokenClaims(e.access_token)}catch(t){if(!e.id_token)throw t;console.log("Failed to fetch token claims from access_token. Attempting to parse id_token instead"),n=this.getTokenClaims(e.id_token)}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+1e3*e.expires_in:void 0,accessToken:e.access_token,idToken:e.id_token,refreshToken:e.refresh_token,scope:t,sessionId:c.v4(),account:{label:n.email||n.unique_name||n.preferred_username||"user@example.com",id:`${n.tid}/${n.oid||n.altsecid||""+n.ipd||""}`}}}exchangeCodeForToken(e,t,o){return n(this,void 0,void 0,(function*(){console.info("Exchanging login code for token");try{const n=r.stringify({grant_type:"authorization_code",code:e,client_id:m,scope:o,code_verifier:t,redirect_uri:p}),i=yield a.commands.executeCommand("workbench.getCodeExchangeProxyEndpoints"),s=i&&i.microsoft||f,c=yield d.default(`${s}common/oauth2/v2.0/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":n.length.toString()},body:n});if(c.ok){console.info("Exchanging login code for token success");const e=yield c.json();return this.getTokenFromResponse(e,o)}throw console.error("Exchanging login code for token failed"),new Error(`Unable to login: ${yield c.text()}`)}catch(e){throw console.error(e.message),e}}))}refreshToken(e,o,i){return n(this,void 0,void 0,(function*(){console.info("Refreshing token...");const n=r.stringify({refresh_token:e,client_id:m,grant_type:"refresh_token",scope:o});let s;try{const e=yield a.commands.executeCommand("workbench.getCodeExchangeProxyEndpoints"),t=e&&e.microsoft||f;s=yield d.default(`${t}common/oauth2/v2.0/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":n.length.toString()},body:n})}catch(e){throw console.error("Refreshing token failed"),new Error(t.REFRESH_NETWORK_FAILURE)}try{if(s.ok){const e=yield s.json(),t=this.getTokenFromResponse(e,o,i);return this.setToken(t,o),console.info("Token refresh success"),t}throw new Error("Bad request.")}catch(e){throw a.window.showErrorMessage("You have been signed out because reading stored authentication information failed."),console.error(`Refreshing token failed: ${s.statusText}`),new Error("Refreshing token failed")}}))}clearSessionTimeout(e){const t=this._refreshTimeouts.get(e);t&&(clearTimeout(t),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const t=this._tokens.findIndex((t=>t.sessionId===e));let o;return t>-1&&(o=this._tokens[t],this._tokens.splice(t,1)),this.clearSessionTimeout(e),o}pollForReconnect(e,o,i){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout((()=>n(this,void 0,void 0,(function*(){try{const n=yield this.refreshToken(o,i,e);t.onDidChangeSessions.fire({added:[],removed:[],changed:[this.convertToSessionSync(n)]})}catch(t){this.pollForReconnect(e,o,i)}}))),18e5))}handleRefreshNetworkError(e,o,i,r=1){return new Promise(((s,a)=>{if(3===r)return console.error("Token refresh failed after 3 attempts"),s(!1);const c=5*r*r;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout((()=>n(this,void 0,void 0,(function*(){try{const n=yield this.refreshToken(o,i,e);return t.onDidChangeSessions.fire({added:[],removed:[],changed:[this.convertToSessionSync(n)]}),s(!0)}catch(t){return s(yield this.handleRefreshNetworkError(e,o,i,r+1))}}))),1e3*c))}))}removeSession(e){return n(this,void 0,void 0,(function*(){console.info(`Logging out of session '${e}'`);const t=this.removeInMemorySessionData(e);let o;return t&&(o=this.convertToSessionSync(t)),0===this._tokens.length?yield this._keychain.deleteToken():this.storeTokenData(),o}))}clearSessions(){return n(this,void 0,void 0,(function*(){console.info("Logging out of all sessions"),this._tokens=[],yield this._keychain.deleteToken(),this._refreshTimeouts.forEach((e=>{clearTimeout(e)})),this._refreshTimeouts.clear()}))}}},5:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MsaAuthProvider=void 0;const i=o(434);class r{constructor(e){this.onDidChangeSessions=i.onDidChangeSessions.event,this.msaService=new i.MSAService(e)}initialize(){return this.msaService.initialize()}getSessions(e){return this.msaService.getSessions(null==e?void 0:e.sort())}createSession(e){return n(this,void 0,void 0,(function*(){const t=yield this.msaService.createSession(e.sort());return i.onDidChangeSessions.fire({added:[t],removed:[],changed:[]}),t}))}removeSession(e){return n(this,void 0,void 0,(function*(){try{const t=yield this.msaService.removeSession(e);t&&i.onDidChangeSessions.fire({added:[],removed:[t],changed:[]})}catch(e){console.error(e)}}))}}t.MsaAuthProvider=r,r.id="msa"},409:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createServer=t.startServer=void 0;const i=o(605),r=o(835),s=o(747),a=o(622);function c(e,t,o){s.readFile(t,((t,n)=>{t?(console.error(t),e.writeHead(404),e.end()):(e.writeHead(200,{"Content-Length":n.length,"Content-Type":o}),e.end(n))}))}t.startServer=function(e){return n(this,void 0,void 0,(function*(){let t;function o(){clearTimeout(t)}const n=new Promise(((o,n)=>{t=setTimeout((()=>{n(new Error("Timeout waiting for port"))}),5e3),e.on("listening",(()=>{const t=e.address();o("string"==typeof t?t:function(e){if(null==e)throw new Error("Assertion Failed: argument is undefined or null");return e}(t).port.toString())})),e.on("error",(e=>{n(new Error("Error listening to server"))})),e.on("close",(()=>{n(new Error("Closed"))})),e.listen(0)}));return n.then(o,o),n}))},t.createServer=function(e){let t;const o=new Promise(((e,o)=>t={resolve:e,reject:o}));let s;const d=new Promise(((e,t)=>s={resolve:e,reject:t})),l=setTimeout((()=>{s.reject(new Error("Timeout waiting for code"))}),3e5);function u(){clearTimeout(l)}const h=i.createServer((function(o,i){const d=r.parse(o.url,!0);switch(d.pathname){case"/signin":if((d.query.nonce||"").replace(/ /g,"+")===e)t.resolve({req:o,res:i});else{const e=new Error("Nonce does not match.");t.resolve({err:e,res:i})}break;case"/":c(i,a.join(__dirname,"../media/auth.html"),"text/html; charset=utf-8");break;case"/auth.css":c(i,a.join(__dirname,"../media/auth.css"),"text/css; charset=utf-8");break;case"/callback":s.resolve(function(e,t){return n(this,void 0,void 0,(function*(){const o=t.query;if(!o||"string"==typeof o)throw new Error("No query received.");let n=o.error_description||o.error;n||((o.state||"").split(",")[1]||"").replace(/ /g,"+")!==e&&(n="Nonce does not match.");const i=o.code;if(!n&&i)return i;throw new Error(n||"No code received.")}))}(e,d).then((e=>({code:e,res:i})),(e=>({err:e,res:i}))));break;default:i.writeHead(404),i.end()}}));return d.then(u,u),{server:h,redirectPromise:o,codePromise:d}}},220:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sha256=void 0,t.sha256=function(e){return n(this,void 0,void 0,(function*(){return o(417).createHash("sha256").update(e).digest("base64")}))}},404:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Keychain=void 0;const i=o(549),r="microsoft-todo-unofficial.login";t.Keychain=class{constructor(e){this.context=e}setToken(e){return n(this,void 0,void 0,(function*(){try{return yield this.context.secrets.store(r,e)}catch(e){if(console.error(`Setting token failed: ${e}`),"The specified item already exists in the keychain."===e.message)return;const t="Troubleshooting Guide";(yield i.window.showErrorMessage(`Writing login information to the keychain failed with error '${e.message}'.`,t))===t&&i.env.openExternal(i.Uri.parse("https://code.visualstudio.com/docs/editor/settings-sync#_troubleshooting-keychain-issues"))}}))}getToken(){return n(this,void 0,void 0,(function*(){try{return yield this.context.secrets.get(r)}catch(e){return console.error(`Getting token failed: ${e}`),Promise.resolve(void 0)}}))}deleteToken(){return n(this,void 0,void 0,(function*(){try{return yield this.context.secrets.delete(r)}catch(e){return console.error(`Deleting token failed: ${e}`),Promise.resolve(void 0)}}))}}},281:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftToDoClientFactory=void 0;const i=o(967),r=o(549);class s{constructor(e){this.globalState=e}getClient(){return n(this,void 0,void 0,(function*(){if(this.loginType&&(this.session=yield r.authentication.getSession(this.loginType,s.scopes),this.session))return i.Client.init({authProvider:e=>{e(void 0,this.session.accessToken)}})}))}getAll(e,t){return n(this,void 0,void 0,(function*(){let o=t;const n=new Array;for(;o;){let t=yield e.api(o).get();t.value.forEach((e=>n.push(e))),o=t["@odata.nextLink"]}return n}))}setLoginType(e){this.loginType=e}clearLoginTypeState(e){return n(this,void 0,void 0,(function*(){"msa"!==e.provider.id&&"microsoft"!==e.provider.id||this.loginType&&(yield this.globalState.update("microsoftToDoUnofficialLoginType",{}),this.setLoginType(void 0),yield r.commands.executeCommand("microsoft-todo-unoffcial.refreshList"))}))}}t.MicrosoftToDoClientFactory=s,s.scopes=["Tasks.ReadWrite","offline_access","openid","profile"]},559:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListOperations=void 0;const i=o(549);class r extends i.Disposable{constructor(e){super((()=>{this.disposables.forEach((e=>e.dispose()))})),this.clientProvider=e,this.disposables=[],this.disposables.push(i.commands.registerCommand("microsoft-todo-unoffcial.createList",(()=>this.createList()))),this.disposables.push(i.commands.registerCommand("microsoft-todo-unoffcial.deleteList",((e,t)=>this.deleteList(e,t))))}getList(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientProvider.getClient();if(t)return(yield t.api(`/me/todo/lists/${e}`).get()).value;yield i.window.showErrorMessage("Not logged in")}))}getLists(){return n(this,void 0,void 0,(function*(){const e=yield this.clientProvider.getClient();if(e)return yield this.clientProvider.getAll(e,"/me/todo/lists");yield i.window.showErrorMessage("Not logged in")}))}createList(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientProvider.getClient();t?(null!=e||(e=yield i.window.showInputBox({prompt:"Add a List",placeHolder:"Groceries",ignoreFocusOut:!0})),e&&(yield t.api("/me/todo/lists").post({displayName:e}),yield i.commands.executeCommand("microsoft-todo-unoffcial.refreshList"))):yield i.window.showErrorMessage("Not logged in")}))}deleteList(e,t){return n(this,void 0,void 0,(function*(){if(!e)return;const o=yield this.clientProvider.getClient();if(!o)return yield i.window.showErrorMessage("Not logged in");const n=(null==t?void 0:t.length)?"Delete lists":"Delete list",r=t?`${t.map((e=>e.entity.displayName)).join('", "')}`:e.entity.displayName;if((yield i.window.showWarningMessage(`"${r}" will be permanently deleted. You won't be able to undo this action.`,{modal:!0},n,"Cancel"))!==n)return;null!=t||(t=[e]);const s=t.map((e=>o.api(`/me/todo/lists/${e.entity.id}`).delete()));yield Promise.all(s),yield i.commands.executeCommand("microsoft-todo-unoffcial.refreshList")}))}}t.ListOperations=r},83:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TaskOperations=void 0;const i=o(549);class r extends i.Disposable{constructor(e){super((()=>{this.disposables.forEach((e=>e.dispose()))})),this.clientProvider=e,this.disposables=[],this.disposables.push(i.commands.registerCommand("microsoft-todo-unoffcial.createTask",(e=>this.createTask(e)))),this.disposables.push(i.commands.registerCommand("microsoft-todo-unoffcial.deleteTask",((e,t)=>this.deleteTask(e,t))))}getTask(e,t){return n(this,void 0,void 0,(function*(){const o=yield this.clientProvider.getClient();if(o)return yield o.api(`/me/todo/lists/${e}/tasks/${t}`).get();yield i.window.showErrorMessage("Not logged in")}))}getTasks(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientProvider.getClient();if(t)return yield this.clientProvider.getAll(t,`/me/todo/lists/${e}/tasks`);yield i.window.showErrorMessage("Not logged in")}))}createTask(e){var t;return n(this,void 0,void 0,(function*(){const o=yield this.clientProvider.getClient();if(!o)return yield i.window.showErrorMessage("Please log in before creating a task.");let n=null==e?void 0:e.entity.id;if(!n){const e=new Array;let r="/me/todo/lists";for(;r;){let t=yield o.api(r).get();t.value.forEach((t=>e.push(t))),r=t["@odata.nextLink"]}const s=e.map((e=>Object.assign({label:e.displayName||""},e)));s.push({label:"Create a new list...",id:"new"});const a=yield i.window.showQuickPick(s,{canPickMany:!1,ignoreFocusOut:!0,placeHolder:"Which list would you like to add tasks to?"});if(n=null===(t=a)||void 0===t?void 0:t.id,"new"===n){const e=yield i.window.showInputBox({prompt:"Add a List",placeHolder:"Groceries",ignoreFocusOut:!0});if(!e)return;n=(yield o.api("/me/todo/lists").post({displayName:e})).id,yield i.commands.executeCommand("microsoft-todo-unoffcial.refreshList")}}if(!n)return;const r={prompt:"Add a Task",placeHolder:"Eat my veggies",ignoreFocusOut:!0};let s=yield i.window.showInputBox(r);for(r.prompt="Add another Task";s;)yield o.api(`/me/todo/lists/${n}/tasks`).post({title:s,body:{content:"",contentType:"text"}}),i.commands.executeCommand("microsoft-todo-unoffcial.refreshList"),s=yield i.window.showInputBox(r)}))}deleteTask(e,t){return n(this,void 0,void 0,(function*(){if(!e)return;const o=yield this.clientProvider.getClient();if(!o)return yield i.window.showErrorMessage("Not logged in");const n=(null==t?void 0:t.length)?"Delete tasks":"Delete task",r=t?`${t.map((e=>e.entity.title)).join('", "')}`:e.entity.title;if((yield i.window.showWarningMessage(`"${r}" will be permanently deleted. You won't be able to undo this action.`,{modal:!0},n,"Cancel"))!==n)return;null!=t||(t=[e]);const s=t.map((e=>o.api(`/me/todo/lists/${e.parent.entity.id}/tasks/${e.entity.id}`).delete()));yield Promise.all(s),yield i.commands.executeCommand("microsoft-todo-unoffcial.refreshList",e.parent)}))}}t.TaskOperations=r},112:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;const i=o(549),r=o(281),s=o(800),a=o(557),c=o(83),d=o(559);o(571);const l=o(5);t.activate=function(e){return n(this,void 0,void 0,(function*(){console.log("Activating!");const t=new l.MsaAuthProvider(e);yield t.initialize(),i.authentication.registerAuthenticationProvider(l.MsaAuthProvider.id,"Microsoft Account (MSA)",t,{supportsMultipleAccounts:!1});const o=new r.MicrosoftToDoClientFactory(e.globalState),u=e.globalState.get("microsoftToDoUnofficialLoginType");let h;u&&o.setLoginType(u.type),e.subscriptions.push(i.commands.registerCommand("microsoft-todo-unoffcial.login",(()=>n(this,void 0,void 0,(function*(){const t=yield i.window.showQuickPick(["Microsoft account","Work or School account"]);if(!t)return;const n="Microsoft account"===t?"msa":"microsoft";yield i.authentication.getSession(n,r.MicrosoftToDoClientFactory.scopes,{createIfNone:!0}),yield e.globalState.update("microsoftToDoUnofficialLoginType",{type:n}),o.setLoginType(n),i.commands.executeCommand("microsoft-todo-unoffcial.refreshList")}))))),e.subscriptions.push(h=i.authentication.onDidChangeSessions((e=>o.clearLoginTypeState(e))));const p=new s.MicrosoftToDoTreeDataProvider(o),f=i.window.createTreeView("microsoft-todo-unoffcial.listView",{treeDataProvider:p,showCollapseAll:!0,canSelectMany:!0});e.subscriptions.push(f);const m=new a.TaskDetailsViewProvider(e.extensionUri,o);f.onDidChangeSelection((e=>n(this,void 0,void 0,(function*(){if(e.selection.length>0){const t=e.selection[0];"task"===t.nodeType&&(yield m.changeChosenView(t))}}))));const y=i.window.registerWebviewViewProvider(m.viewType,m);e.subscriptions.push(y),e.subscriptions.push(i.commands.registerCommand("microsoft-todo-unoffcial.showTaskDetailsView",(()=>n(this,void 0,void 0,(function*(){yield i.commands.executeCommand("setContext","showTaskDetailsView",!0)}))))),e.subscriptions.push(i.commands.registerCommand("microsoft-todo-unoffcial.hideTaskDetailsView",(()=>n(this,void 0,void 0,(function*(){yield i.commands.executeCommand("setContext","showTaskDetailsView",!1)})))));const v=new c.TaskOperations(o),g=new d.ListOperations(o);e.subscriptions.push(v),e.subscriptions.push(g)}))},t.deactivate=function(){}},800:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftToDoTreeDataProvider=void 0;const i=o(549);var r;!function(e){e.completed="Completed",e.inProgress="In Progress"}(r||(r={}));class s extends i.Disposable{constructor(e){super((()=>this.dispose())),this.clientFactory=e,this.didChangeTreeData=new i.EventEmitter,this.onDidChangeTreeData=this.didChangeTreeData.event,this.disposibles=[],this.importanceFilter=!1,this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.refreshList",(e=>this.didChangeTreeData.fire(e)))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.complete",((e,t)=>t?this.changeCompletedState(t):this.changeCompletedState([e])))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.uncomplete",((e,t)=>t?this.changeCompletedState(t):this.changeCompletedState([e])))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.star",((e,t)=>t?this.changeImportanceState(t):this.changeImportanceState([e])))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.unstar",((e,t)=>t?this.changeImportanceState(t):this.changeImportanceState([e])))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.starFilter",(()=>n(this,void 0,void 0,(function*(){this.importanceFilter=!0,yield i.commands.executeCommand("setContext","starFilter",!0),this.didChangeTreeData.fire()}))))),this.disposibles.push(i.commands.registerCommand("microsoft-todo-unoffcial.unstarFilter",(()=>n(this,void 0,void 0,(function*(){this.importanceFilter=!1,yield i.commands.executeCommand("setContext","starFilter",!1),this.didChangeTreeData.fire()})))))}changeCompletedState(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientFactory.getClient(),o=e.map((e=>n(this,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${e.parent.entity.id}/tasks/${e.entity.id}`).patch({status:"completed"===e.entity.status?"notStarted":"completed"}),this.didChangeTreeData.fire(e.parent)}))));yield Promise.all(o)}))}changeImportanceState(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientFactory.getClient(),o=e.map((e=>n(this,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${e.parent.entity.id}/tasks/${e.entity.id}`).patch({importance:"high"===e.entity.importance?"normal":"high"}),this.didChangeTreeData.fire(e.parent)}))));yield Promise.all(o),this.importantNode&&this.didChangeTreeData.fire(this.importantNode)}))}getTreeItem(e){var t;let o;switch(e.nodeType){case"create-list":o=new i.TreeItem("Create a new list..."),o.command={command:"microsoft-todo-unoffcial.createList",title:"Create a new list..."};break;case"list":o=new i.TreeItem({label:e.entity.displayName||""},i.TreeItemCollapsibleState.Collapsed),o.contextValue=e.nodeType,e.entity.isShared&&(o.description="👥");break;case"task":let n=e.entity.title||"",s=`*${n}*`;const a=e.entity.dueDateTime,c=[];if(null==a?void 0:a.dateTime){const e=" DUE "+new Date(a.dateTime).toLocaleDateString()+" ";n+="  ",c.push([n.length,n.length+e.length]),n+=e}(null===(t=e.entity.body)||void 0===t?void 0:t.content)&&(s+=`\n\n${e.entity.body.content}`);const d={label:n,highlights:c};o=new i.TreeItem(d,i.TreeItemCollapsibleState.None);const l="completed"===e.entity.status?"completed":"notcompleted",u="high"===e.entity.importance?"starred":"notstarred";o.contextValue=`${e.nodeType}-${l} ${e.nodeType}-${u}`,o.tooltip=new i.MarkdownString(s,!0);break;case"status":const h=e.statusType===r.completed?i.TreeItemCollapsibleState.Collapsed:i.TreeItemCollapsibleState.Expanded,p=` ${e.statusType} `;o=new i.TreeItem({highlights:[[0,p.length]],label:p},h);break;case"important-list":o=new i.TreeItem({label:"⭐️ Important"},i.TreeItemCollapsibleState.Collapsed)}return o}getChildren(e){return n(this,void 0,void 0,(function*(){const t=yield this.clientFactory.getClient();if(t){if(!e){const e=yield this.clientFactory.getAll(t,"/me/todo/lists");this.importantNode={nodeType:"important-list"};const o=[this.importantNode];return e.forEach((e=>o.push({nodeType:"list",entity:e}))),o.push({nodeType:"create-list"}),o}if("list"===e.nodeType){const o=o=>n(this,void 0,void 0,(function*(){let n=`status ${o?"eq":"ne"} 'completed'`;return this.importanceFilter&&(n+=" and importance eq 'high'"),(yield this.clientFactory.getAll(t,`/me/todo/lists/${e.entity.id}/tasks?$filter=${n}`)).map((t=>({nodeType:"task",entity:t,parent:e})))}));return[{nodeType:"status",getChildren:()=>o(!1),statusType:r.inProgress},{nodeType:"status",getChildren:()=>o(!0),statusType:r.completed}]}if("status"===e.nodeType)return yield e.getChildren();if("important-list"===e.nodeType){const e="status ne 'completed' and importance eq 'high'",o=yield this.clientFactory.getAll(t,"/me/todo/lists"),n=[];for(const i of o)(yield this.clientFactory.getAll(t,`/me/todo/lists/${i.id}/tasks?$filter=${e}`)).forEach((e=>{n.push({nodeType:"task",entity:e,parent:{entity:i,nodeType:"list"}})}));return n}}}))}dispose(){this.disposibles.forEach((e=>e.dispose()))}}t.MicrosoftToDoTreeDataProvider=s},270:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewViewBase=t.WebviewBase=t.getNonce=void 0;const i=o(549);t.getNonce=function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let o=0;o<32;o++)e+=t.charAt(Math.floor(Math.random()*t.length));return e};class r{constructor(){this._disposables=[],this._onIsReady=new i.EventEmitter,this.MESSAGE_UNHANDLED="message not handled",this._waitForReady=new Promise((e=>{const t=this._onIsReady.event((()=>{t.dispose(),e()}))}))}initialize(){var e;null===(e=this._webview)||void 0===e||e.onDidReceiveMessage((e=>n(this,void 0,void 0,(function*(){yield this._onDidReceiveMessage(e)}))),null,this._disposables)}_onDidReceiveMessage(e){return n(this,void 0,void 0,(function*(){switch(e.command){case"ready":return void this._onIsReady.fire();default:return this.MESSAGE_UNHANDLED}}))}_postMessage(e){var t;return n(this,void 0,void 0,(function*(){yield this._waitForReady,null===(t=this._webview)||void 0===t||t.postMessage(e)}))}_replyMessage(e,t){var o;return n(this,void 0,void 0,(function*(){const n={seq:e.req,res:t};null===(o=this._webview)||void 0===o||o.postMessage(n)}))}_throwError(e,t){var o;return n(this,void 0,void 0,(function*(){const n={seq:e.req,err:t};null===(o=this._webview)||void 0===o||o.postMessage(n)}))}dispose(){this._disposables.forEach((e=>e.dispose()))}}t.WebviewBase=r,t.WebviewViewBase=class extends r{show(e){this._view?this._view.show(e):i.commands.executeCommand(`${this.viewType}.focus`)}}},557:function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TaskDetailsViewProvider=void 0;const i=o(549),r=o(270);class s extends r.WebviewViewBase{constructor(e,t){super(),this._extensionUri=e,this.clientFactory=t,this.viewType="microsoft-todo-unoffcial.taskDetailsView"}changeChosenView(e){return n(this,void 0,void 0,(function*(){this.chosenTask=e,yield i.commands.executeCommand("setContext","showTaskDetailsView",!0),this.show(!0),yield this._postMessage(e)}))}resolveWebviewView(e,t,o){const r=Object.create(null,{initialize:{get:()=>super.initialize}});return n(this,void 0,void 0,(function*(){this._view=e,this._webview=e.webview,this._webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},r.initialize.call(this),this._webview.html=this.getHtmlForWebview(),this._disposables.push(e.webview.onDidReceiveMessage((e=>n(this,void 0,void 0,(function*(){switch(e.command){case"cancel":yield i.commands.executeCommand("microsoft-todo-unoffcial.closeCreateTask");break;case"update":const t=yield this.clientFactory.getClient();if(!t)return yield i.window.showErrorMessage("you're not logged in.");const o={title:e.body.title,body:{content:e.body.note,contentType:"text"}};if(e.body.dueDate){const[t,n,i]=e.body.dueDate.split("/");o.dueDateTime={dateTime:`${i}-${t}-${n}T08:00:00.0000000`,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}}else o.dueDateTime=null;if(e.body.reminderDate){if(!e.body.reminderTime)return void i.window.showErrorMessage("You need to specify a time when adding a Reminder.");const[t,n,r]=e.body.reminderDate.split("/");o.reminderDateTime={dateTime:`${r}-${t}-${n}T${e.body.reminderTime}:00.0000000`,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}}else o.reminderDateTime=null;yield t.api(`/me/todo/lists/${e.body.listId}/tasks/${e.body.id}`).patch(o),yield i.commands.executeCommand("microsoft-todo-unoffcial.refreshList")}})))))}))}getHtmlForWebview(){if(!this._webview)throw new Error("bad state: no webview found");const e=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"webviews","taskDetailsView","main.js")),t=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"webviews","common","reset.css")),o=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"webviews","common","vscode.css")),n=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"webviews","taskDetailsView","main.css")),s=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"node_modules","tiny-date-picker","tiny-date-picker.min.css")),a=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"node_modules","tiny-date-picker","dist","tiny-date-picker.min.js")),c=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"node_modules","moment","min","moment.min.js")),d=this._webview.asWebviewUri(i.Uri.joinPath(this._extensionUri,"node_modules","moment-timezone","builds","moment-timezone-with-data-10-year-range.min.js")),l=r.getNonce();return`<!DOCTYPE html>\n\t\t\t<html lang="en">\n\t\t\t<head>\n\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\x3c!--\n\t\t\t\t\tUse a content security policy to only allow loading images from https or from our extension directory,\n\t\t\t\t\tand only allow scripts that have a specific nonce.\n\t\t\t\t--\x3e\n\t\t\t\t<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${this._webview.cspSource}; script-src 'nonce-${l}';">\n\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t\t<link href="${t}" rel="stylesheet">\n\t\t\t\t<link href="${o}" rel="stylesheet">\n\t\t\t\t<Link href="${s}" rel="stylesheet">\n\t\t\t\t<link href="${n}" rel="stylesheet">\n\t\t\t\t<title>Task details</title>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<input placeholder='Add Title' type='text' class='task-title' value=''/>\n\t\t\t\t<div class='task-reminder-form'>\n\t\t\t\t\t<input placeholder='Add Reminder' type='text' class='task-reminder-date' value=''/>\n\t\t\t\t\t<input type='hidden' class='task-reminder-time' />\n\t\t\t\t</div>\n\t\t\t\t<input placeholder='Add Due Date' type='text' class='task-duedate' value=''/>\n\t\t\t\t<label for="task-body">Note</label>\n\t\t\t\t<textarea placeholder='Add Note' class='task-body'></textarea>\n\t\t\t\t<button class='update update-task' hidden>Update</button>\n\t\t\t\t<button class='update update-cancel' hidden>Cancel</button>\n\t\t\t\t<script nonce="${l}" src="${a}"><\/script>\n\t\t\t\t<script nonce="${l}" src="${c}"><\/script>\n\t\t\t\t<script nonce="${l}" src="${d}"><\/script>\n\t\t\t\t<script nonce="${l}" src="${e}"><\/script>\n\t\t\t</body>\n\t\t\t</html>`}}t.TaskDetailsViewProvider=s},277:(e,t,o)=>{"use strict";o.r(t),o.d(t,{NIL:()=>E,parse:()=>v,stringify:()=>u,v1:()=>y,v3:()=>w,v4:()=>b,v5:()=>T,validate:()=>d,version:()=>_});var n=o(417),i=o.n(n);const r=new Uint8Array(256);let s=r.length;function a(){return s>r.length-16&&(i().randomFillSync(r),s=0),r.slice(s,s+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,d=function(e){return"string"==typeof e&&c.test(e)},l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).substr(1));const u=function(e,t=0){const o=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!d(o))throw TypeError("Stringified UUID is invalid");return o};let h,p,f=0,m=0;const y=function(e,t,o){let n=t&&o||0;const i=t||new Array(16);let r=(e=e||{}).node||h,s=void 0!==e.clockseq?e.clockseq:p;if(null==r||null==s){const t=e.random||(e.rng||a)();null==r&&(r=h=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=p=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),d=void 0!==e.nsecs?e.nsecs:m+1;const l=c-f+(d-m)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||c>f)&&void 0===e.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=c,m=d,p=s,c+=122192928e5;const y=(1e4*(268435455&c)+d)%4294967296;i[n++]=y>>>24&255,i[n++]=y>>>16&255,i[n++]=y>>>8&255,i[n++]=255&y;const v=c/4294967296*1e4&268435455;i[n++]=v>>>8&255,i[n++]=255&v,i[n++]=v>>>24&15|16,i[n++]=v>>>16&255,i[n++]=s>>>8|128,i[n++]=255&s;for(let e=0;e<6;++e)i[n+e]=r[e];return t||u(i)},v=function(e){if(!d(e))throw TypeError("Invalid UUID");let t;const o=new Uint8Array(16);return o[0]=(t=parseInt(e.slice(0,8),16))>>>24,o[1]=t>>>16&255,o[2]=t>>>8&255,o[3]=255&t,o[4]=(t=parseInt(e.slice(9,13),16))>>>8,o[5]=255&t,o[6]=(t=parseInt(e.slice(14,18),16))>>>8,o[7]=255&t,o[8]=(t=parseInt(e.slice(19,23),16))>>>8,o[9]=255&t,o[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,o[11]=t/4294967296&255,o[12]=t>>>24&255,o[13]=t>>>16&255,o[14]=t>>>8&255,o[15]=255&t,o};function g(e,t,o){function n(e,n,i,r){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let o=0;o<e.length;++o)t.push(e.charCodeAt(o));return t}(e)),"string"==typeof n&&(n=v(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),s=o(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,i){r=r||0;for(let e=0;e<16;++e)i[r+e]=s[e];return i}return u(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}const w=g("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("md5").update(e).digest()})),b=function(e,t,o){const n=(e=e||{}).random||(e.rng||a)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){o=o||0;for(let e=0;e<16;++e)t[o+e]=n[e];return t}return u(n)},T=g("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("sha1").update(e).digest()})),E="00000000-0000-0000-0000-000000000000",_=function(e){if(!d(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},293:e=>{"use strict";e.exports=require("buffer")},417:e=>{"use strict";e.exports=require("crypto")},747:e=>{"use strict";e.exports=require("fs")},605:e=>{"use strict";e.exports=require("http")},622:e=>{"use strict";e.exports=require("path")},191:e=>{"use strict";e.exports=require("querystring")},835:e=>{"use strict";e.exports=require("url")},549:e=>{"use strict";e.exports=require("vscode")}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=o(112);module.exports=n})();